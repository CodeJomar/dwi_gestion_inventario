<div th:fragment="modal-password" id="passwordResetModal"
  class="hidden modal-hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 backdrop-blur-sm"
  th:classappend="${mantenerModalPassword} ? 'modal-visible' : 'hidden'">
  <div class="bg-card rounded-2xl w-[450px] max-w-[90%] shadow-2xl border border-border overflow-hidden">
    <!-- Header del modal -->
    <div class="bg-primary p-6 flex items-center justify-between">
      <div class="flex items-center">
        <svg class="w-6 h-6 text-primary-foreground mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z">
          </path>
        </svg>
        <h3 class="text-xl font-bold text-primary-foreground">Cambiar Contraseña</h3>
      </div>
      <button id="closeModal" class="text-primary-foreground hover:bg-white/20 rounded-lg p-1 transition-colors">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <!-- Contenido del modal -->
    <form id="passwordResetForm" class="p-6 space-y-5" th:action="@{/cambiar-password}" th:object="${cambioPassword}"
      method="post" novalidate>
      <!-- Email -->
      <div>
        <label class="block text-muted-foreground mb-2 font-medium text-sm" for="resetEmail">Correo Electrónico</label>
        <div class="flex items-center border border-border rounded-xl overflow-hidden bg-input">
          <svg class="w-5 h-5 ml-4 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z">
            </path>
          </svg>

          <input th:field="*{email}" name="email" id="resetEmail" type="email"
            class="w-full bg-transparent px-4 py-3 text-foreground placeholder-gray-400 outline-none focus:ring-0"
            placeholder="tu@email.com" required>
        </div>

        <p th:if="${#fields.hasErrors('email')}" th:errors="*{email}" class="text-red-500 text-xs m-0"></p>

      </div>

      <!-- Contraseña Antigua -->
      <div>
        <label class="block text-muted-foreground mb-2 font-medium text-sm" for="oldPassword">Contraseña Actual</label>
        <div class="relative flex items-center border border-border rounded-xl overflow-hidden bg-input">
          <svg class="w-5 h-5 ml-4 text-muted-foreground flex-shrink-0" fill="none" stroke="currentColor"
            viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z">
            </path>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z">
            </path>
          </svg>

          <input th:field="*{oldPassword}" name="oldPassword" id="oldPassword" type="password"
            class="w-full bg-transparent px-4 py-3 text-foreground placeholder-gray-400 outline-none focus:ring-0 pr-12"
            placeholder="••••••••" required>

          <button type="button"
            class="toggle-password absolute right-0 top-0 h-full w-12 flex items-center justify-center text-muted-foreground hover:text-primary transition-colors focus:outline-none"
            data-target="oldPassword">
            <svg class="eye-icon w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z">
              </path>
            </svg>
          </button>
        </div>

        <p th:if="${#fields.hasErrors('oldPassword')}" th:errors="*{oldPassword}" class="text-red-500 text-xs m-0"></p>

      </div>

      <!-- Nueva Contraseña -->
      <div>
        <label class="block text-muted-foreground mb-2 font-medium text-sm" for="newPassword">Nueva Contraseña</label>
        <div class="relative flex items-center border border-border rounded-xl overflow-hidden bg-input">
          <svg class="w-5 h-5 ml-4 text-muted-foreground flex-shrink-0" fill="none" stroke="currentColor"
            viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z">
            </path>
          </svg>

          <input th:field="*{newPassword}" name="newPassword" id="newPassword" type="password"
            class="w-full bg-transparent px-4 py-3 text-foreground placeholder-gray-400 outline-none focus:ring-0 pr-12"
            placeholder="••••••••" required>

          <button type="button"
            class="toggle-password absolute right-0 top-0 h-full w-12 flex items-center justify-center text-muted-foreground hover:text-primary transition-colors focus:outline-none"
            data-target="newPassword">
            <svg class="eye-icon w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z">
              </path>
            </svg>
          </button>
        </div>

        <p th:if="${#fields.hasErrors('newPassword')}" th:errors="*{newPassword}" class="text-red-500 text-xs m-0"></p>


      </div>

      <!-- Botones de acción -->
      <div class="flex gap-3 pt-4">
        <button type="button" id="cancelButton"
          class="flex-1 bg-input hover:bg-border text-foreground font-semibold py-3 rounded-xl transition-all duration-300">
          Cancelar
        </button>
        <button type="submit"
          class="flex-1 bg-primary hover:bg-primary/90 text-primary-foreground font-semibold py-3 rounded-xl transition-all duration-300 transform hover:scale-[1.02] shadow-lg shadow-primary/40">
          Actualizar
        </button>
      </div>
    </form>
  </div>
</div>